<div class="highlight"><pre><span></span><span class="gh">MediaWiki è®¾ç½®SMTPå‘é€é‚®ä»¶</span>
<span class="gh">=========================================</span>

<span class="nc">:slug:</span> <span class="nf">smtp_for_mediawiki</span>
<span class="nc">:lang:</span> <span class="nf">zh</span>
<span class="nc">:date:</span> <span class="nf">2016-02-18 15:20</span>
<span class="nc">:tags:</span> <span class="nf">mediawiki,notes</span>
<span class="nc">:series:</span> <span class="nf">MediaWiki</span>

<span class="cp">.. PELICAN_BEGIN_SUMMARY</span>

ä¸º MediaWiki è®¾ç½®é€šè¿‡ SMTP å‘é€é‚®ä»¶.å°±æ˜¯è¿™æ ·  _(:Ğ·ã€âˆ )_ 

<span class="cp">.. PELICAN_END_SUMMARY</span>

<span class="p">..</span> <span class="ow">contents</span><span class="p">::</span>

<span class="gh">ä¸ºå•¥è¦æ SMTP å‘ä¿¡?</span>
<span class="gh">-----------------------------</span>

<span class="m">*</span> é‚®ä»¶åŠŸèƒ½åœ¨é‡ç½®å¯†ç å’Œé€šçŸ¥æ—¶éå¸¸é‡è¦ (ï½¥Ï‰ï½¥)

<span class="m">*</span> å¬è¯´ç”¨ PHP çš„ mail() å‡½æ•°å‘é€çš„é‚®ä»¶å®¹æ˜“è¢«å½“æˆåƒåœ¾é‚®ä»¶(ç„¶è€Œå’±å‹æ ¹æ²¡æ”¶åˆ°ğŸ˜‚

æ‰€ä»¥æ‰è¦æ SMTP å‘—~

<span class="gh">å®‰è£…éœ€è¦çš„åº“</span>
<span class="gh">------------------------------</span>

PHP 7 æœ¨æœ‰ pear å•¦ (Arch Linux å®˜æ–¹æºåœ¨ PHP7 å‡çº§åä»å®˜æ–¹æºé‡Œç§»é™¤äº† <span class="na">:code:</span><span class="nv">`php-pear`</span> )~,æ‰€ä»¥é€šè¿‡ composer å®‰è£…å‘—~

é¦–å…ˆå®‰è£…ä¸Š composer ,å¦‚æœæ±åœ¨ç”¨ Arch Linux çš„è¯:

    sudo pacman -S php-composer
    
å…¶å®ƒç³»ç»Ÿçš„è¯,å¯ä»¥å‚ç…§ <span class="s">`Composer å®˜æ–¹çš„å®‰è£…æŒ‡å— </span><span class="si">&lt;https://getcomposer.org/download/&gt;</span><span class="s">`_</span> è¿›è¡Œå®‰è£…å‘—~

åœ¨å®‰è£…ä¸Š composer ä»¥åå®‰è£… mail å’Œ smtp åŒ…:

    composer require --update-no-dev pear/mail pear/net_smtp
    
å¦‚æœæ±åƒå’±ä¸€æ ·å®‰è£…çš„æ˜¯ alpha ç‰ˆ(ä» Git ä¸‹è½½çš„,å»æ‰ <span class="na">:code:</span><span class="nv">`--update-no-dev`</span> é€‰é¡¹.

è¿˜åœ¨ç”¨ PHP 5? ç”¨ pear å®‰è£…:

    sudo pear install Mail Net_SMTP

<span class="gh">è®¾ç½® $wgSMTP å’Œ $wgPasswordSender å˜é‡</span>
<span class="gh">-------------------------------------------</span>

<span class="s">`MediaWiki.org çš„æŒ‡å— </span><span class="si">&lt;https://www.mediawiki.org/wiki/Manual:$wgSMTP&gt;</span><span class="s">`_</span>

<span class="na">:code:</span><span class="nv">`$wgSMTP`</span> å¤§æ¦‚åƒè¿™æ ·:

<span class="p">..</span> <span class="ow">code-block</span><span class="p">::</span> <span class="k">php</span>

    <span class="x">$wgSMTP = array(</span>
    <span class="x">    &#39;host&#39;     =&gt; &quot;mail.example.com&quot;, // SMTP æœåŠ¡å™¨çš„åœ°å€ (æˆ–IP).å¦‚æœä½¿ç”¨äº†SSL,è®°å¾—åŠ ä¸Š ssl://</span>
    <span class="x">    &#39;IDHost&#39;   =&gt; &quot;example.com&quot;,      // æ±çš„åŸŸå,å¯é€‰.å¦‚æœä¸è®¾ç½®çš„è¯ä¼šè®¾ç½®æˆ $wgServer çš„å€¼.</span>
    <span class="x">    &#39;port&#39;     =&gt; 25,                 // ç«¯å£(ä¸€èˆ¬æ˜¯25,SSLæ˜¯465,StartTLSæ˜¯587)</span>
    <span class="x">    &#39;auth&#39;     =&gt; true,               // æ˜¯å¦éœ€è¦ SMTP è®¤è¯ (å¤šåŠéƒ½éœ€è¦å‘—~)</span>
    <span class="x">    &#39;username&#39; =&gt; &quot;my_user_name&quot;,     // SMTP è®¤è¯çš„ç”¨æˆ·å.</span>
    <span class="x">    &#39;password&#39; =&gt; &quot;my_password&quot;       // SMTP è®¤è¯çš„å¯†ç .</span>
    <span class="x">);</span>
    <span class="x"></span>
ä¸¾ä¸ªæ —å­  _(:Ğ·ã€âˆ )_ :

<span class="p">..</span> <span class="ow">code-block</span><span class="p">::</span> <span class="k">php</span>

    <span class="x">$wgSMTP = array(</span>
    <span class="x">    &#39;host&#39;     =&gt; &quot;smtp.yandex.com&quot;, // å’±ç”¨çš„æ˜¯ Yandex çš„ Domain mail~</span>
    <span class="x">    &#39;port&#39;     =&gt; 587,                 // StartTLS =w=</span>
    <span class="x">    &#39;auth&#39;     =&gt; true,               // éœ€è¦ç™»å½• ğŸ˜‚</span>
    <span class="x">    &#39;username&#39; =&gt; &quot;sender@yoitsu.moe&quot;,     // ç”¨æˆ·åå•¦~</span>
    <span class="x">    &#39;password&#39; =&gt; &quot;foo&quot;       // å¯†ç å•¦~</span>
    <span class="x">);</span>
    <span class="x"></span>
æœ‰äº›æ—¶å€™ SMTP æœåŠ¡å™¨è¦æ±‚å¤–å‘é‚®ä»¶åœ°å€ä¸­çš„å‘ä»¶äººå’Œå®é™…ä¸€è‡´ (ä¾‹å¦‚ Yandex ),è¿™æ—¶éœ€è¦è®¾ç½® <span class="na">:code:</span><span class="nv">`$wgPasswordSender`</span> å˜é‡:

<span class="p">..</span> <span class="ow">code-block</span><span class="p">::</span> <span class="k">php</span>

    <span class="x">$wgPasswordSender=&quot;sender@yoitsu.moe&quot;;</span>
    <span class="x"></span>
ä¿®æ”¹å®Œä»¥åç”¨æŸä¸ªåŠŸèƒ½(ä¾‹å¦‚ä¿®æ”¹é‚®ä»¶åœ°å€æµ‹è¯•ä¸€ä¸‹å‘—~):

<span class="p">..</span> <span class="ow">image</span><span class="p">::</span> images/smtptest.png
   <span class="nc">:alt:</span> <span class="nf">Parsoidçš„å·¥ä½œåŸç†</span>
</pre></div>
